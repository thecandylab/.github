# .github/ISSUE_TEMPLATE/security-report.yml
name: "ğŸ›¡ï¸ Reporte de Seguridad"
description: "Reportar vulnerabilidad de seguridad (PRIVADO)"
title: "[SECURITY] "
labels: ["type:security", "prio:P0"]
body:
  - type: markdown
    attributes:
      value: |
        ## ğŸ”’ Reporte Confidencial de Seguridad

        **âš ï¸ IMPORTANTE:** Este reporte serÃ¡ privado y solo visible para mantenedores.

        **Para vulnerabilidades CRÃTICAS**, usa: https://github.com/thecandylab/.github/security/advisories/new

  - type: input
    id: title
    attributes:
      label: "TÃ­tulo de la Vulnerabilidad"
      description: "DescripciÃ³n concisa del problema"
      placeholder: "Ej: XSS en formulario de contacto"
    validations:
      required: true

  - type: dropdown
    id: severity
    attributes:
      label: "Nivel de Severidad"
      options:
        - "ğŸ”´ P0 - CrÃ­tico (RCE, bypass auth, datos sensibles)"
        - "ğŸŸ  P1 - Alto (EscalaciÃ³n privilegios)"
        - "ğŸŸ¡ P2 - Medio (Impacto limitado)"
        - "ğŸŸ¢ P3 - Bajo (Mejora de seguridad)"
    validations:
      required: true

  - type: dropdown
    id: area
    attributes:
      label: "Ãrea Afectada"
      options:
        - "area:frontend"
        - "area:backend"
        - "area:db"
        - "area:infrastructure"
        - "area:devops"
        - "area:dependencies"
    validations:
      required: true

  - type: textarea
    id: description
    attributes:
      label: "DescripciÃ³n Detallada"
      description: "Explica la vulnerabilidad tÃ©cnicamente"
      placeholder: "La vulnerabilidad permite... Se encuentra en... El impacto es..."
    validations:
      required: true

  - type: textarea
    id: reproduction
    attributes:
      label: "Pasos para Reproducir"
      description: "Instrucciones paso a paso para replicar el issue"
      placeholder: "1. Ir a...\n2. Hacer click en...\n3. Introducir...\n4. Observar..."
    validations:
      required: true

  - type: textarea
    id: impact
    attributes:
      label: "Impacto Potencial"
      description: "QuÃ© podrÃ­a hacer un atacante explotando esto"
    validations:
      required: true

  - type: checkboxes
    id: terms
    attributes:
      label: "Confirmaciones"
      options:
        - label: "Acepto no divulgar pÃºblicamente esta vulnerabilidad hasta que sea parcheada"
          required: true
        - label: "Para vulnerabilidades P0/P1, usarÃ© Security Advisories en lugar de esta plantilla"
          required: false
